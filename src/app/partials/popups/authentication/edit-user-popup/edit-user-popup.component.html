<div class="d-flex align-items-center no-gutters edit-profilr-wrapper">
  <div class="col-sm-8 col-md-12 col-lg-12 mx-auto">
    <div class="navbar-shadow">
      <div class="card-header text-center">
        <h5 class="card-title">
          Edit <strong class="text-primary">{{ popupData.userConfigToUpdate.type }}</strong>
        </h5>
      </div>
      <div class="alert alert-warning text-center" role="alert">
        <i class="far fa-hand-point-right pr-2 text-primary"></i>All the
        <span class="text-danger pl-1 asterisk">* </span>&nbsp;fields are compulsory
      </div>
      <div
        class="pb-2 pl-4 pr-4 no-gutters max-vertical-h-60 stylishSlimScroll flow-y-auto flow-x-hidden animated fadeInUp"
      >
        <ng-container *ngTemplateOutlet="userProfile"></ng-container>
      </div>
      <div class="card-footer">
        <div class="col-12 text-center mt-3">
          <button mat-flat-button color="primary" (click)="submit()" class="rounded-pill ml-2">
            Update
          </button>
          <button mat-flat-button color="primary" mat-dialog-close="true" class="rounded-pill ml-2">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #userProfile>
  <div class="row w100 no-gutters">
    <ng-container *ngIf="popupData.userConfigToUpdate.type !== 'Experience'">
      <div class="form-group col-12" *ngFor="let item of popupData.userConfigToUpdate.data">
        <label class="form-label" for="name">{{ item.label }}</label>
        <div class="input-group input-group-merge">
          <input
            [id]="item.label"
            type="text"
            *ngIf="!item?.textarea && !item?.isDropdown"
            [(ngModel)]="user[item.key]"
            class="form-control form-control-prepended"
            placeholder="Your {{ item.label }}"
          />
          <textarea
            [id]="item.label"
            cols="30"
            *ngIf="item?.textarea && !item?.isDropdown"
            rows="10"
            [(ngModel)]="user[item.key]"
            class="form-control form-control-prepended"
            placeholder="Your {{ item.label }}"
          ></textarea>
          <ng-container *ngIf="item?.isDropdown">
            <ng-template [ngTemplateOutlet]="country" [ngTemplateOutletContext]="{ data: item }"> </ng-template>
          </ng-container>
        </div>
        <!-- <small
              [hidden]="userDetailsForm.controls.lastName.valid || userDetailsForm.controls.lastName.untouched"
              class="text-danger"
              translate
            >
              Last Name is required
            </small> -->
      </div>
    </ng-container>
    <ng-container *ngIf="popupData.userConfigToUpdate.type === 'Experience' && user">
      <ng-container *ngTemplateOutlet="experience"></ng-container>
    </ng-container>
    <ng-container *ngIf="popupData.userConfigToUpdate.type === 'Education' && user">
      <ng-container *ngTemplateOutlet="education"></ng-container>
    </ng-container>
  </div>
</ng-template>

<ng-template #experience>
  <div class="col-12 text-right">
    <button
      mat-mini-fab
      color="primary"
      matTooltipPosition="below"
      matTooltip="Add More Experience"
      (click)="addExp()"
      class="ml-2 rounded-pill mb-2"
    >
      <mat-icon>add</mat-icon>
    </button>
  </div>
  <div class="form-group col-12" *ngFor="let item of user.experience; let i = index">
    <mat-accordion>
      <mat-expansion-panel class="mb-1" [expanded]="i == 0">
        <mat-expansion-panel-header>
          <mat-panel-title class="text-primary">
            <strong>Experience {{ i + 1 }}</strong>
          </mat-panel-title>
          <mat-panel-description class="d-flex justify-content-end">
            <div class="text-right">
              <mat-icon
                matTooltipPosition="below"
                matTooltip="Remove Experience"
                *ngIf="user.experience.length > 1"
                (click)="removeExp(i)"
                >remove_circle_outline</mat-icon
              >
            </div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="pt-2">
          <div class="row no-gutters">
            <div class="col-6">
              <div class="form-group">
                <label class="form-label" for="currentRole"
                  >Designation<span class="text-danger pl-1 asterisk">*</span></label
                >
                <div class="input-group input-group-merge">
                  <input
                    id="currentRole{{ i }}"
                    type="text"
                    [(ngModel)]="item.currentRole[0]"
                    class="form-control form-control-prepended"
                  />
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group pl-2">
                <label class="form-label" for="organization"
                  >Organization<span class="text-danger pl-1 asterisk">*</span></label
                >
                <div class="input-group input-group-merge">
                  <input
                    type="text"
                    id="organization{{ i }}"
                    [(ngModel)]="item.organization"
                    class="form-control form-control-prepended"
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="description"
              >Job Description<span class="text-danger pl-1 asterisk">*</span></label
            >
            <div class="input-group input-group-merge">
              <input
                type="text"
                id="description{{ i }}"
                [(ngModel)]="item.description[0]"
                class="form-control form-control-prepended"
              />
            </div>
          </div>
          <div class="d-flex">
            <div class="form-group w45">
              <label class="form-label" for="experienceFrom"
                >Job Start Date<span class="text-danger pl-1 asterisk">*</span></label
              >
              <div class="input-group input-group-merge">
                <input
                  matInput
                  class="form-control form-control-prepended"
                  [matDatepicker]="picker1"
                  readonly
                  [(ngModel)]="item.experienceFrom"
                />
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1 color="primary"></mat-datepicker>
              </div>
            </div>
            <div class="form-group pl-2 w45">
              <label class="form-label" for="experienceTo"
                >Job End Date<span class="text-danger pl-1 asterisk">*</span></label
              >
              <div class="input-group input-group-merge">
                <input
                  matInput
                  class="form-control form-control-prepended"
                  [matDatepicker]="picker2"
                  readonly
                  [(ngModel)]="item.experienceTo"
                />
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2 color="primary"></mat-datepicker>
              </div>
            </div>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</ng-template>

<ng-template #education>
  <!-- college: ["PGTC"]
degreeFromDate: null
degreeToDate: null
highestDegree: "MCA"
major: "CS"
minor: [""]
university: ["Kol"] -->
  <div class="col-12 text-right">
    <button
      mat-mini-fab
      color="primary"
      matTooltipPosition="below"
      matTooltip="Add More Education"
      (click)="addEdu()"
      class="ml-2 rounded-pill mb-2"
    >
      <mat-icon>add</mat-icon>
    </button>
  </div>
  <div class="form-group col-12" *ngFor="let item of user.education; let i = index">
    <mat-accordion>
      <mat-expansion-panel class="mb-1" [expanded]="i == 0">
        <mat-expansion-panel-header>
          <mat-panel-title class="text-primary">
            <strong>Education {{ i + 1 }}</strong>
          </mat-panel-title>
          <mat-panel-description class="d-flex justify-content-end">
            <div class="text-right">
              <mat-icon
                matTooltipPosition="below"
                matTooltip="Remove Education"
                *ngIf="user.education.length > 1"
                (click)="removeEdu(i)"
                >remove_circle_outline</mat-icon
              >
            </div>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="pt-2">
          <div class="row no-gutters">
            <div class="col-6">
              <div class="form-group">
                <label class="form-label" for="currentRole"
                  >Degree<span class="text-danger pl-1 asterisk">*</span></label
                >
                <div class="input-group input-group-merge">
                  <input
                    id="highestDegree{{ i }}"
                    type="text"
                    [(ngModel)]="item.highestDegree[0]"
                    class="form-control form-control-prepended"
                  />
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group pl-2">
                <label class="form-label" for="organization"
                  >School/College<span class="text-danger pl-1 asterisk">*</span></label
                >
                <div class="input-group input-group-merge">
                  <input
                    type="text"
                    id="college{{ i }}"
                    [(ngModel)]="item.college"
                    class="form-control form-control-prepended"
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="description"
              >University<span class="text-danger pl-1 asterisk">*</span></label
            >
            <div class="input-group input-group-merge">
              <input
                type="text"
                id="university{{ i }}"
                [(ngModel)]="item.university[0]"
                class="form-control form-control-prepended"
              />
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="description"
              >Major<span class="text-danger pl-1 asterisk">*</span></label
            >
            <div class="input-group input-group-merge">
              <input
                type="text"
                id="major{{ i }}"
                [(ngModel)]="item.major"
                class="form-control form-control-prepended"
              />
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="description"
              >Minor<span class="text-danger pl-1 asterisk">*</span></label
            >
            <div class="input-group input-group-merge">
              <input
                type="text"
                id="minor{{ i }}"
                [(ngModel)]="item.minor[0]"
                class="form-control form-control-prepended"
              />
            </div>
          </div>
          <div class="d-flex">
            <div class="form-group w45">
              <label class="form-label" for="degreeFromDate"
                >Degree Start Date<span class="text-danger pl-1 asterisk">*</span></label
              >
              <div class="input-group input-group-merge">
                <input
                  matInput
                  class="form-control form-control-prepended"
                  [matDatepicker]="picker1"
                  readonly
                  [(ngModel)]="item.degreeFromDate"
                />
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1 color="primary"></mat-datepicker>
              </div>
            </div>
            <div class="form-group pl-2 w45">
              <label class="form-label" for="degreeToDate"
                >Degree End Date<span class="text-danger pl-1 asterisk">*</span></label
              >
              <div class="input-group input-group-merge">
                <input
                  matInput
                  class="form-control form-control-prepended"
                  [matDatepicker]="picker2"
                  readonly
                  [(ngModel)]="item.degreeToDate"
                />
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2 color="primary"></mat-datepicker>
              </div>
            </div>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</ng-template>

<ng-template #country let-data="data">
  <mat-select [(ngModel)]="user[data.key]" placeholder="Your Country" required class="form-control form-control-prepended">
    <mat-option *ngFor="let country of countries" [value]="country.title">
      {{ country.title }}
    </mat-option>
  </mat-select>
</ng-template>
