<div class="all-course-wrapper">
  <mat-drawer-container class="saved-conditions-wrapper" [hasBackdrop]="false">
    <mat-drawer #filterDrawer [position]="'end'" [mode]="'over'" class="flow-hidden">
      <div id="course-filter" style="width: 300px;">
        <div class="row d-flex align-items-center border-bottom">
          <div class="col-9">
            <p class="m-0 pl-2 h5 text-primary">Filters</p>
          </div>
          <div class="col text-right">
            <button (click)="filterDrawer.toggle()" mat-icon-button>
              <mat-icon class="text-primary">clear</mat-icon>
            </button>
          </div>
        </div>
        <ng-template [ngTemplateOutlet]="filterActions"></ng-template>
      </div>
    </mat-drawer>
    <mat-drawer-content>
      <div class="container">
        <ol class="breadcrumb mt-3">
          <li class="breadcrumb-item curPoint"><a [routerLink]="['/home']">Home</a></li>
          <li class="breadcrumb-item active"><a>All Job Listings</a></li>
        </ol>
        <section class="All-course-page-section min-vertical-h-100">
          <div class="row no-gutters">
            <ng-container *ngIf="isLoading">
              <div
                class="col-sm-6 animated fadeIn"
                *ngFor="let item of [1, 2, 3, 4]"
              >
                <div class="card">
                  <div class="card-img skeleton">
                    <!-- waiting for img to load from javascript -->
                  </div>
                  <div class="card-body">
                    <h2 class="card-title skeleton">
                      <!-- wating for title to load from javascript -->
                    </h2>
                    <p class="card-intro skeleton">
                      <!-- waiting for intro to load from Javascript -->
                    </p>
                  </div>
                </div>
              </div>
            </ng-container>
            <div class="position-absolute mt-2 ml-2">
              <button
                mat-mini-fab
                color="primary"
                style="z-index: 9;"
                class="mr-1"
                (click)="filterDrawer.open()"
                matTooltipPosition="below"
                matTooltip="Show Filter"
                *ngIf="!isLoading"
              >
                <mat-icon>filter_list</mat-icon>
              </button>

              <button
                mat-mini-fab
                color="primary"
                style="z-index: 9;"
                class="d-none mr-1"
                *ngIf="!isLoading && checkFilter() != 0"
                matTooltipPosition="below"
                matTooltip="Remove Filter"
                (click)="removeFilter()"
              >
                <mat-icon>clear</mat-icon>
              </button>

              <button
                mat-mini-fab
                color="primary"
                style="z-index: 9;"
                class="mr-1"
                *ngIf="user && user.type.toLowerCase() == 'admin' && !isLoading"
                matTooltipPosition="below"
                matTooltip="Select / Deselect"
                [matMenuTriggerFor]="menu"
              >
                <mat-icon>menu</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <button mat-menu-item (click)="selDeAll('select')" class="h6">
                  Select All
                </button>
                <button mat-menu-item (click)="selDeAll('deselect')" class="h6">
                  Deselect All
                </button>
              </mat-menu>
              <button
                mat-mini-fab
                color="primary"
                style="z-index: 9;"
                class="mr-1"
                *ngIf="user && user.type.toLowerCase() == 'admin' && !isLoading"
                matTooltipPosition="below"
                matTooltip="Edit Course"
                [disabled]="checkDisable()"
              >
                <mat-icon>edit</mat-icon>
              </button>
            </div>

            <mat-paginator
              class="col-12"
              [length]="length"
              [pageSize]="pageSize"
              [pageSizeOptions]="pageSizeOptions"
              (page)="pageEvent = pagination($event)"
              *ngIf="!isLoading"
            >
            </mat-paginator>

        	<ng-container *ngIf="!isLoading && allJobs.length">
		        <div class="row" id="jobsArea">
		          <div
		            class="col-12 animated fadeIn mb-4 w100"
		            id="jobPanel-{{ i }}"
		            *ngFor="let course of allJobs; let i = index"
		          >
		            <mat-accordion multi>
		              <mat-expansion-panel class="jobs-panel" [expanded]="i == 0">
		                <mat-expansion-panel-header class="d-flex align-items-center">
		                  <mat-panel-title class="pt-3">
		                    <h6 class="text-primary mt-2 pb-2">{{ course.title }}</h6>
		                  </mat-panel-title>
		                  <mat-panel-description>
		                    <div class="text-right mr-2 pt-4">
		                      <span class="card-intro pr-1 p-1" *ngFor="let item of course.tags"
		                        ><badge class="badge badge-info">{{ item }}</badge></span
		                      >
		                    </div>
		                  </mat-panel-description>
		                </mat-expansion-panel-header>
		                <div class="mt-4">
		                  <div class="row">
		                    <div class="col-12 col-md-6">
		                      <mat-form-field class="pb-2 w100">
		                        <mat-label>Name</mat-label>
		                        <input matInput placeholder="Ex. Frontend Developer" [value]="course.title" readonly/>
		                      </mat-form-field>
		                    </div>
		                    <div class="col-12 col-md-6">
		                      <mat-form-field class="pb-2 w100">
		                        <mat-label>Created By</mat-label>
		                        <input
		                          matInput
		                          placeholder="Ex. Adam"
		                          [value]="course.createdBy"
		                          readonly
		                        />
		                      </mat-form-field>
		                    </div>
		                    <div class="col-12 col-md-6">
		                      <mat-form-field class="pb-2 w100">
		                        <mat-label>Job Location</mat-label>
		                      	<input matInput placeholder="Job Location" [value]="course.location" readonly/>
		                      </mat-form-field>
		                    </div>
		                    <div class="col-12 col-md-6">
		                      <mat-form-field class="pb-2 w100">
		                      	<mat-label>Job Status</mat-label>
		                      	<input matInput placeholder="Job Status" [value]="course.status" readonly/>
		                      </mat-form-field>
		                    </div>
		                    <div class="col-12">
		                      <mat-form-field class="pb-2 w100">
		                        <mat-label>Description</mat-label>
		                        <textarea matInput rows="3" placeholder="Job Description" [value]="course.description" readonly></textarea>
		                      </mat-form-field>
		                    </div>
		                    <div class="col-12">
		                      <mat-form-field class="example-chip-list pb-2 w100">
		                        <mat-chip-list #chipList aria-label="Fruit selection">
		                          <mat-chip
		                            *ngFor="let item of course.tags; let tagIndex = index"
		                            [selectable]="selectable"
		                            [removable]="removable"
		                            (removed)="remove(course, tagIndex)"
		                          >
		                            {{ item }}
		                            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
		                          </mat-chip>
		                          <input
		                            placeholder="Tags"
		                            [matChipInputFor]="chipList"
		                            [matChipInputAddOnBlur]="addOnBlur"    
		                          />
		                        </mat-chip-list>
		                      </mat-form-field>
		                    </div>
		                  </div>
		                  <div class="text-center">
				              <button
				              	  mat-flat-button
				                  color="primary"
				                  matTooltipPosition="below"
				                  matTooltip="Apply For This Job"
				                  class="rounded-pill ml-2"
				                  (click)="applyForJob(course, $event)">
				                  <span>Apply</span>
				              </button>
				          </div>     
		                </div>
		              </mat-expansion-panel>
		            </mat-accordion>
		          </div>
		        </div>
     		</ng-container>
            <ng-container *ngIf="!isLoading && allJobs.length == 0">
              <div class="text-center m-auto animated fadeIn">
                <div class="col-12 min-vertical-h-90 max-vertical-h-90 flow-hidden text-center">
                  <img src="../../../assets/images/NoRecordFound.png" class="img-fluid d-block mx-auto w100 mt-5" />

                  <button mat-flat-button color="primary" (click)="removeFilter()" class="rounded-pill ml-2">
                    Remove All Filters
                  </button>
                </div>
              </div>
            </ng-container>
          </div>
        </section>
      </div>
    </mat-drawer-content>
  </mat-drawer-container>
</div>

<ng-template #filterActions>
  <div class="animated fadeIn p-3 ml-2">
    <div class="row no-gutters">
      <div class="max-vertical-h-75 stylishSlimScroll flow-y-auto flow-x-hidden">
        <div class="col-12">
          <mat-form-field class="example-full-width">
            <label for="" class="h6 d-block">Search Course</label>
            <input matInput type="text" [(ngModel)]="searchConfig.text" />
          </mat-form-field>
        </div>
        <div class="col-12">
          <div class="row">
            <div class="col-5">
              <mat-form-field class="example-full-width w100">
                <label for="" class="h6 d-block">Min Disc</label>
                <input
                  type="number"
                  matInput
                  [(ngModel)]="searchConfig.discountStart"
                  min="0"
                  step="1"
                  oninput="validity.valid||(value='');"
                />
              </mat-form-field>
            </div>
            <div class="col-5">
              <mat-form-field class="example-full-width w100">
                <label for="" class="h6 d-block">Max Disc</label>
                <input
                  type="number"
                  matInput
                  [(ngModel)]="searchConfig.discountEnd"
                  min="0"
                  step="1"
                  oninput="validity.valid||(value='');"
                />
              </mat-form-field>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="row">
            <div class="col-5">
              <mat-form-field class="example-full-width w100">
                <label for="" class="h6 d-block">Min Price</label>
                <input
                  type="number"
                  matInput
                  [(ngModel)]="searchConfig.priceStart"
                  min="0"
                  step="1"
                  oninput="validity.valid||(value='');"
                />
              </mat-form-field>
            </div>
            <div class="col-5">
              <mat-form-field class="example-full-width w100">
                <label for="" class="h6 d-block">Max Price</label>
                <input
                  type="number"
                  matInput
                  [(ngModel)]="searchConfig.priceEnd"
                  min="0"
                  step="1"
                  oninput="validity.valid||(value='');"
                />
              </mat-form-field>
            </div>
          </div>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Program</label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.programs" [value]="searchConfig.programs" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item" *ngFor="let item of filterData.programs">{{ item }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Language </label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.languages" [value]="searchConfig.languages" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item" *ngFor="let item of filterData.languages">{{ item }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Subject </label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.subjects" [value]="searchConfig.subjects" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item" *ngFor="let item of filterData.subjects">{{ item }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Level</label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.levels" [value]="searchConfig.levels" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item" *ngFor="let item of filterData.levels">{{ item }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Tier</label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.tier" [value]="searchConfig.tier" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item.name" *ngFor="let item of filterData.tiers">{{ item.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="col-12">
          <label for="" class="h6 d-block">Categories</label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="searchConfig.category" [value]="searchConfig.category" ngDefaultControl>
              <mat-option value="">None</mat-option>
              <mat-option [value]="item.code" *ngFor="let item of filterData.categories">{{ item.code }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="col-12 text-center mt-3">
        <button mat-flat-button color="primary" (click)="applyFilter()" class="rounded-pill ml-2">
          Apply Search
        </button>
      </div>
    </div>
  </div>
</ng-template>