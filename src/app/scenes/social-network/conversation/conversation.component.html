<div class="conversation-wrapper">
  <div class="container">
    <ol class="breadcrumb mt-3">
      <li class="breadcrumb-item curPoint"><a [routerLink]="['/dashboard']">Dashboard</a></li>
      <li class="breadcrumb-item active"><a>My Conversations</a></li>
    </ol>
    <div class="sec-title">
      <div class="title">Messages</div>
    </div>
    <!-- <ng-container *ngIf="networkConfig.isLoading">
        <div class="col-12 animated fadeIn" *ngFor="let item of [1, 2, 3, 4, 5, 6]">
          <div class="card ml-0 mr-0 my-4" style="height: 100px !important;">
            <div class="card-img skeleton"></div>
          </div>
        </div>
      </ng-container> -->
    <ng-container *ngIf="user">
      <ng-template *ngTemplateOutlet="chatSection"></ng-template>
    </ng-container>
  </div>
</div>

<ng-template #chatSection>
  <div id="frame" class="mb-4 shadow-lg">
    <div id="sidepanel">
      <div id="profile">
        <div class="wrap">
          <img
            id="profile-img"
            src="{{
              user.image != ''
                ? user.image
                : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
            }}"
            class="online"
            alt=""
          />
          <p>{{ user.firstName }} {{ user.lastName }}</p>
          <!-- <i class="fa fa-chevron-down expand-button" aria-hidden="true"></i> -->
          <div id="status-options">
            <ul>
              <li id="status-online" class="active">
                <span class="status-circle"></span>
                <p>Online</p>
              </li>
              <li id="status-away">
                <span class="status-circle"></span>
                <p>Away</p>
              </li>
              <li id="status-busy">
                <span class="status-circle"></span>
                <p>Busy</p>
              </li>
              <li id="status-offline">
                <span class="status-circle"></span>
                <p>Offline</p>
              </li>
            </ul>
          </div>
          <div id="expanded">
            <label for="twitter"><i class="fa fa-facebook fa-fw" aria-hidden="true"></i></label>
            <input name="twitter" type="text" value="mikeross" />
            <label for="twitter"><i class="fa fa-twitter fa-fw" aria-hidden="true"></i></label>
            <input name="twitter" type="text" value="ross81" />
            <label for="twitter"><i class="fa fa-instagram fa-fw" aria-hidden="true"></i></label>
            <input name="twitter" type="text" value="mike.ross" />
          </div>
        </div>
      </div>
      <div id="search">
        <label for=""><i class="fa fa-search" aria-hidden="true"></i></label>
        <input type="text" [(ngModel)]="searchedName" placeholder="Search contacts..." />
      </div>
      <div id="contacts">
        <ul *ngIf="connectedUserConfig.data.length">
          <li
            class="contact"
            [ngClass]="{ active: connectionConfig.selectedUser?.id === item.id }"
            (click)="afterUserSelected(item)"
            *ngFor="let item of connectedUserConfig.data | nameFilter: searchedName; let first = first"
          >
            <div class="wrap">
              <span class="contact-status online"></span>
              <img
                src="{{
                  item.imageUrl
                    ? item.imageUrl
                    : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
                }}"
                alt="User Image"
              />
              <div class="meta">
                <p class="name">{{ item.firstName }} {{ item.lastName }}</p>
                <!-- <p class="preview">You just got LITT up, Mike.</p> -->
              </div>
            </div>
          </li>
          <!-- <li class="contact active">
            <div class="wrap">
              <span class="contact-status busy"></span>
              <img src="http://emilcarlsson.se/assets/harveyspecter.png" alt="" />
              <div class="meta">
                <p class="name">Harvey Specter</p>
                <p class="preview">
                  Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of
                  a hundred and forty six other things.
                </p>
              </div>
            </div>
          </li> -->
        </ul>
        <ng-container *ngIf="connectedUserConfig.isLoading">
          <ng-template *ngTemplateOutlet="loader"></ng-template>
        </ng-container>

        <ng-container *ngIf="connectedUserConfig.data.length == 0 && !connectedUserConfig.isLoading">
          <div class="text-center m-auto animated fadeIn">
            <div>
              <h1>ðŸ˜•</h1>
              <h6 class="text-white">No users...</h6>
            </div>
          </div>
        </ng-container>
      </div>
      <div id="bottom-bar">
        <button id="addcontact">
          <i class="fa fa-user-plus fa-fw" aria-hidden="true"></i> <span>Add contact</span>
        </button>
        <button id="settings"><i class="fa fa-cog fa-fw" aria-hidden="true"></i> <span>Settings</span></button>
      </div>
    </div>
    <div class="content">
      <div class="contact-profile" *ngIf="connectionConfig.selectedUser">
        <img
          src="{{
            connectionConfig.selectedUser?.imageUrl
              ? connectionConfig.selectedUser?.imageUrl
              : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
          }}"
          alt=""
        />
        <p>
          <a
            [routerLink]="['/social-network/profile/', connectionConfig.selectedUser?.tasaId]"
            routerLinkActive="router-link-active"
            >{{ connectionConfig.selectedUser?.firstName }} {{ connectionConfig.selectedUser?.lastName }} </a
          > ( <span class="text-muted">{{ connectionConfig.selectedUser?.summary }}</span> )
        </p>
        <div class="social-media">
          <i class="fab fa-facebook-f"></i>
          <i class="fab fa-twitter"></i>
          <i class="fab fa-linkedin-in"></i>
        </div>
      </div>
      <div class="messages" [ngClass]="{ 'd-flex align-items-center': connectionConfig.currentMsgList.length === 0 }">
        <ul *ngIf="connectionConfig.currentMsgList.length">
          <li
            [ngClass]="{ sent: item.from === user.email, replies: item.to === user.email, 'last-msg': last }"
            *ngFor="let item of connectionConfig.currentMsgList; let last = last"
          >
            <img
              *ngIf="item.from === user.email"
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <img
              *ngIf="item.to === user.email"
              src="{{
                connectionConfig.selectedUser?.imageUrl
                  ? connectionConfig.selectedUser?.imageUrl
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>{{ item.message }}</p>
          </li>
          <!-- <li class="replies">
            <img
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>When you're backed against the wall, break the god damn thing down.</p>
          </li>
          <li class="replies">
            <img
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>Excuses don't win championships.</p>
          </li>
          <li class="sent">
            <img
              src="{{
                connectionConfig.selectedUser?.imageUrl
                  ? connectionConfig.selectedUser?.imageUrl
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>Oh yeah, did Michael Jordan tell you that?</p>
          </li>
          <li class="replies">
            <img
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>No, I told him that.</p>
          </li>
          <li class="replies">
            <img
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>What are your choices when someone puts a gun to your head?</p>
          </li>
          <li class="sent">
            <img
              src="{{
                connectionConfig.selectedUser?.imageUrl
                  ? connectionConfig.selectedUser?.imageUrl
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>What are you talking about? You do what they say or they shoot you.</p>
          </li>
          <li class="replies">
            <img
              src="{{
                user.image != ''
                  ? user.image
                  : 'https://raw.githubusercontent.com/azouaoui-med/pro-sidebar-template/gh-pages/src/img/user.jpg'
              }}"
              alt=""
            />
            <p>
              Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a
              hundred and forty six other things.
            </p>
          </li> -->
        </ul>
        <ng-container *ngIf="connectionConfig.currentMsgList.length == 0">
          <div class="text-center m-auto animated fadeIn">
            <div>
              <h1>ðŸ’¬</h1>
              <h6 class="text-muted">Select the user from left hand side for chat...</h6>
            </div>
          </div>
        </ng-container>
      </div>
      <div class="message-input">
        <div class="wrap">
          <input type="text" (keyup.enter)="newMessage()" placeholder="Write your message..." />
          <i class="fa fa-paperclip attachment" aria-hidden="true"></i>
          <button class="submit" (click)="newMessage()"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #loader>
  <div class="col-12 animated fadeIn" *ngFor="let item of [1, 2, 3, 4, 5]">
    <div class="card ml-0 mr-0" style="height: 50px !important;">
      <div class="card-img skeleton"></div>
    </div>
  </div>
</ng-template>

<audio #audioOption>
  <source src="http://soundbible.com/mp3/Elevator Ding-SoundBible.com-685385892.mp3" controls type="audio/mp3" />
</audio>
